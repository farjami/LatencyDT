// Decision Tree 2: Aggressive Early Checks, Defer Expensive Scans
digraph {
	fontsize=20 label="Decision Tree 2: Aggressive Early Checks, Defer Expensive Scans" labelloc=t
	rankdir=TB
	T2_ROOT [label="IPB: Src IP in bad_ip_list?
Cost: 3" fillcolor=lightblue shape=box style=filled]
	T2_ROOT -> T2_OUT_MAL_IPB [label=Yes]
	T2_ROOT -> T2_N1 [label=No]
	T2_OUT_MAL_IPB [label="MALICIOUS (IPB)
Path Cost: 3" fillcolor=lightcoral shape=ellipse style=filled]
	T2_N1 [label="PC: Port suspicious_port_X?
Cost: 1" fillcolor=lightblue shape=box style=filled]
	T2_N1 -> T2_OUT_MAL_SUSP_PORT [label=Yes]
	T2_N1 -> T2_N2 [label=No]
	T2_OUT_MAL_SUSP_PORT [label="MALICIOUS (Susp Port)
Path Cost: 4" fillcolor=lightcoral shape=ellipse style=filled]
	T2_N2 [label="PC: Port 443?
Cost: 1" fillcolor=lightblue shape=box style=filled]
	T2_N2 -> T2_N3 [label="Yes (~80%)"]
	T2_N2 -> T2_N5 [label=No]
	T2_N3 [label="SNI: SNI benign?
Cost: 2" fillcolor=lightblue shape=box style=filled]
	T2_N3 -> T2_OUT_BEN_SNI [label=Yes]
	T2_N3 -> T2_N4 [label="No/Sus"]
	T2_OUT_BEN_SNI [label="BENIGN (SNI OK)
Path Cost: 7" fillcolor=lightgreen shape=ellipse style=filled]
	T2_N4 [label="SM: 'malware.exe'?
Cost: 10" fillcolor=lightblue shape=box style=filled]
	T2_N4 -> T2_OUT_MAL_SM1 [label=Yes]
	T2_N4 -> T2_OUT_BEN_SM1 [label=No]
	T2_OUT_MAL_SM1 [label="MALICIOUS (SM)
Path Cost: 17" fillcolor=lightcoral shape=ellipse style=filled]
	T2_OUT_BEN_SM1 [label="BENIGN (No SM)
Path Cost: 17" fillcolor=lightgreen shape=ellipse style=filled]
	T2_N5 [label="PC: Port 80?
Cost: 1" fillcolor=lightblue shape=box style=filled]
	T2_N5 -> T2_N6 [label="Yes (~10%)"]
	T2_N5 -> T2_N8 [label=No]
	T2_N6 [label="HHP: URI benign?
Cost: 2" fillcolor=lightblue shape=box style=filled]
	T2_N6 -> T2_OUT_BEN_HHP [label=Yes]
	T2_N6 -> T2_N7 [label="No/Sus"]
	T2_OUT_BEN_HHP [label="BENIGN (HHP OK)
Path Cost: 8" fillcolor=lightgreen shape=ellipse style=filled]
	T2_N7 [label="SM: 'malware.exe'?
Cost: 10" fillcolor=lightblue shape=box style=filled]
	T2_N7 -> T2_OUT_MAL_SM2 [label=Yes]
	T2_N7 -> T2_OUT_BEN_SM2 [label=No]
	T2_OUT_MAL_SM2 [label="MALICIOUS (SM)
Path Cost: 18" fillcolor=lightcoral shape=ellipse style=filled]
	T2_OUT_BEN_SM2 [label="BENIGN (No SM)
Path Cost: 18" fillcolor=lightgreen shape=ellipse style=filled]
	T2_N8 [label="PC: Port 53?
Cost: 1" fillcolor=lightblue shape=box style=filled]
	T2_N8 -> T2_N9 [label="Yes (~5%)"]
	T2_N8 -> T2_N10 [label=No]
	T2_N9 [label="DQC: Check DNS Query
Cost: 2" fillcolor=lightblue shape=box style=filled]
	T2_N9 -> T2_OUT_BEN_DNS [label=OK]
	T2_N9 -> T2_OUT_MAL_DNS [label=NOK]
	T2_OUT_BEN_DNS [label="BENIGN (DNS)
Path Cost: 9" fillcolor=lightgreen shape=ellipse style=filled]
	T2_OUT_MAL_DNS [label="MALICIOUS (DNS)
Path Cost: 9" fillcolor=lightcoral shape=ellipse style=filled]
	T2_N10 [label="SM: 'malware.exe'?
Cost: 10" fillcolor=lightblue shape=box style=filled]
	T2_N10 -> T2_OUT_MAL_SM3 [label=Yes]
	T2_N10 -> T2_OUT_BEN_SM3 [label=No]
	T2_OUT_MAL_SM3 [label="MALICIOUS (SM)
Path Cost: 17" fillcolor=lightcoral shape=ellipse style=filled]
	T2_OUT_BEN_SM3 [label="BENIGN (No SM)
Path Cost: 17" fillcolor=lightgreen shape=ellipse style=filled]
}
